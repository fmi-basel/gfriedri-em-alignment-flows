profiles {
    standard {
        conda.enabled = true
        conda.useMamba = true
        conda.cacheDir = "$baseDir/../infrastructure/envs/"

        process {
            executor = 'local'

            withLabel: 'cpu' {
                conda = "$baseDir/../infrastructure/env-yamls/environment.yaml"
                cpus = 2
            }

            withLabel: 'gpu' {
                conda = "$baseDir/../infrastructure/env-yamls/environment.yaml"
                cpus = 2
            }
        }
    }


    slurm {
        conda.enabled = true
        conda.useMamba = true
        conda.cacheDir = "$baseDir/../infrastructure/envs/"

        process {
            executor = 'slurm'
            queueSize = 50
            submitRateLimit = '10/2min'
            queue = 'main'

            withLabel: 'cpu' {
                conda = "$baseDir/../infrastructure/env-yamls/environment.yaml"
                cpus = 16
                memory = '16 GB'
                clusterOptions = '--time=4:00:00 --constraint "infiniband"'
            }
            withLabel: 'gpu' {
                conda = "$baseDir/../infrastructure/env-yamls/environment.yaml"
                cpus = 12
                memory = '96 GB'
                clusterOptions = '--time=4:00:00 --gres=gpu:a40:1 --constraint "infiniband"'
            }
        }
    }
}
